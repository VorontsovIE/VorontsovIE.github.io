---
layout: page
title: Виртуальные окружения Python при помощи venv
permalink: /python-venv/
---
# Виртуальные окружения Python при помощи venv

В норме python умеет работать лишь с одной версией каждой библиотеки и ставит её в папку общую для всех пользователей. Из-за этого возникает три проблемы:
* разным проектам могут потребоваться разные версии библиотек (и далеко не всегда самая новая подходит лучше старых)

* пользователь без прав администратора вообще не может установить библиотеку, потому что у него нет доступа на запись к этой общей папке

* в системе может быть установлено несколько версий интерпретатора, у каждого из которых свой набор библиотек. При установке библиотек и запуске программы довольно легко забыть, какая из версий python используется

Чтобы решить все три проблемы, принято для каждого проекта создавать своё виртуальное окружение. Фактически, это локальная "копия" питона нужной версии, плюс набор всех библиотек (конкретных версий), которые нужны этому проекту. Эта копия "живёт", как правило, в папке проекта в скрытой подпапке `.venv`. (В linux папки, с названием, начинающимся с точки, считаются скрытыми).

## Создание виртуального окружения

Чтобы создать виртуальное окружение, необходимо запустить модуль `venv` и указать папку, в которой виртуальное окружение будет храниться (`.venv`, как мы уже говорили). В последних версиях питона он встроенный, так что ничего специально устанавливать не требуется.

Для начала нам нужно в командной строке зайти в папку проекта:

**`cd /path/to/project`**

Затем запустить модуль venv:

**`python -m venv .venv`**

> Если у вас есть предпочтения по версии питон, которая необходима, то модуль venv следует запускать при помощи той версии питона, которую мы собираемся использовать в дальнейшем. Например, если у нас есть python 2.7, python 3.6 и python 3.8, и мы планируем использовать версию 3.6, нам следует написать:  
>  `/path/to/python3.6 -m venv .venv`


> Если вам требуются библиотеки, которые устанавливать долго и нудно (например, tensorflow), а в системе они уже стоят, то можно добавить ключ `--system-site-packages`, тогда ваше окружение будет использоваться как дополнение к системному:  
> `python -m venv .venv --system-site-packages`

## Активация виртуального окружения

После того как вы создали окружение, его следует активировать:
* В Windows для этого нужно запустить (в командной строке) файл

**`.venv\Scripts\activate.bat`**

* В Linux/MacOS нужно особым запустить (опять же, в терминале) файл при помощи команды source:

**`source .venv/bin/activate`**

**(!)** Окружение деактивируется каждый раз, когда терминал (консоль, командная строка) закрывается, так что при включении командной строки надо всякий раз активировать окружение

> Если вы зачем-то хотите вручную деактивировать окружение, не закрывая терминал, достаточно вызывать команду `deactivate`.

## Работа в виртуальном окружении

После того, как вы активировали окружение, команды python и pip будут работать с этим окружением.

Устанавливать библиотеки (в активированном окружении) можно одним из этих двух способов:

**`pip install some-awesome-package`**

  или

**`python -m pip install some-awesome-package`**

Все библиотеки, которые вы установите, будут относиться только к этому проекту и будут подключаться после активации.

Запускать скрипты следует так:

**`python script.py`**
